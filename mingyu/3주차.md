# 김민규

생성일: 2022년 8월 17일 오전 11:10

# HTTP 메서드 활용

- 쿼리 파라미터를 통한 데이터 전송은 주로 GET에서 많이 사용함. 정렬 필터링에서도 많이 씀 graphql에선 어캐 변환해주는겨?
- 메시지 바디를 통한 데이터 전송: POST, PUT, PATCH 리소스 등록이나 변경할 때 자주 씀

## 클라이언트에서 서버로 데이터 전송

### 정적 데이터 조회

- get으로 리소스 path만 넣어서 고고

### 동적 데이터 조회

- 쿼리파라미터 사용 ex) search?q=hello&hl=ko
- 조회 조건을 줄여주는 필터, 조회 결과를 정렬하는 정렬 조건에 주로 사용

### HTML Form 데이터 전송

웹브라우저가 form data를 읽어서 http message를 생성해준다.

form 내용을 메시지 바디를 통해 (key=value)형식으로 보내주고

전송 데이터를 url encoding 처리

form tag method를 get으로 바꾸면 안됨. (대신 조회에서만 사용하자요)

![Untitled](%E1%84%80%E1%85%B5%E1%86%B7%E1%84%86%E1%85%B5%E1%86%AB%E1%84%80%E1%85%B2%20e5f1ee869ad84abf9e6ff94a6803cc61/Untitled.png)

### multipart/form-data

파일전송할 때 웹브라우저가 boundary 경계를 잘라서 데이터 타입에 따라 잘라서 넣어 보내줌.

## HTTP API 데이터 전송

- 서버 to 서버
- 앱 클라이언트 (아이폰, 안드로이드)
- 웹 클라이언트 HTML에서 Form 전송 대신 자바스크립트를 통한 통신에 사용(AJAX)
  ex) React, Vue 같은 웹 클라이언트와 API xhdtls
- Content-Type: application/json을 주로 사용 (사실상 표준) TEXT, XML, JSON 등등

## POST

데이터 등록할때 서버에서 uri 생성하고 관리(컬렉션), 클라이언트는 등록될 uri를 모름.

컬렉션(Collection)

- 서버가 관리하는 리소스 디렉토리
- 서버가 리소스의 URI를 생성하고 관리

### 파일 관리 시스템

- 파일 등록 /files/{filename}. → PUT (파일이 있을 경우 지우고 등록해야 하기 때문)

왜 PUT을 씀? POST를 안쓰고

- 클라이언트가 리소스 URI를 알고 있어야 한다.
- 파일 등록 /files/{filename} 클라이언트가 파일의 이름을 알고 있어야한다.
- 클라이언트가 직접 리소스의 URI를 지정함.
- Store → 클라이언트가 관리하는 리소스 저장소

## HTML FORM 사용

- HTML FORM은 GET, POST만 지원
- 컨트롤 URI
  GET, POST만 지원하므로 제약이 있음
  이런 제약을 해결하기 위해 동사로 된 리소스 경로 사용
  POST의 /new, /edit, /delete, /update 등등이 컨트롤 URI
  HTTP 메서드로 해결하기 어려운 경우 사용(HTTP API 포함)

![Untitled](%E1%84%80%E1%85%B5%E1%86%B7%E1%84%86%E1%85%B5%E1%86%AB%E1%84%80%E1%85%B2%20e5f1ee869ad84abf9e6ff94a6803cc61/Untitled%201.png)

## HTTP 상태 코드

클라이언트가 보낸 요청의 처리 상태를 응답에서 알려주는 기능

- 2xx (Successful) 요청 정상 처리
- 3xx (Redirection) 요청을 완료하려면 추가 행동이 필요
- 4xx (Client Error) 클라이언트 오류, 잘못된 문법등으로 서버가 요청을 수행할 수 없음
- 5xx (Server Error) 서버 오류, 서버가 정상 요청을 처리하지 못함

### 만약 모르는 상태 코드가 나타나면?

클라이언트가 인식할 수 없는 상태코드를 서버가 반환하면?

몇 백번대인지 앞 자리를 보고 판단하면 될듯

## 3xx (Redirection)

요청을 완료하기 위해 유저 에이전트(웹 브라우저) 추가 조치 필요

- 웹 브라우저는 3xx 응답의 결과에 Location 헤더가 있으면 location 헤더 위치로 자동 이동

## 종류

- 영구 리다이렉션 = 특정 리소스의 URI가 영구적으로 이동
  ex) /members → /users
- 일시 리다이렉션 - 일시적인 변경
  ex) 주문 완료 후 주문 내역 화면으로 이동
  PRG: Post/Redirect/Get
- 특수 리다이렉션
  결과 대신 캐시를 사용

## 영구 리다이렉션

301, 308

- 리소스의 URI가 영구적으로 이동
- 원래의 URL을 사용x, 검색 엔진 등에서도 변경 인지
- 301: 리다이렉트시 요청 메서드가 get으로 변하고, 본문이 제거될 수 있음
- 308: 리다이렉트시 요청 메서드와 본문 유지(처음 post를 보내면 리다이렉트도 post)

## 일시적 리다이렉션

- 리소스의 URI가 일시적으로 변경
- 따라서 검색 엔진 등에서 URL을 변경하면 안됨
- 302 Found
  리다이렉트시 요청 메서드가 Get으로 변하고, 본문이 제거될 수 있음
- 307
  302와 기능은 같음 근데 요청 시 메서드와 본문 유지
- 303
  302와 기능은 같은데 요청 메서드가 Get으로 변경

### 일시적 리다이렉션 언제씀 PRG

- Post로 주문후에 웹 브라우저를 새로고침하면?
- 새로고침은 다시 요청
- 중복 주문이 될 수 있다.

post로 주문후에 주문 결과 화면을 get 메서드로 리다이렉트

새로고침해도 결과 화면을 get으로 페이지 조회

중복 주문 대신에 결과 화면만 get으로 다시 요청

## 기타 리다이렉션

- 304
  캐시를 목적으로 사용
  클라이언트에게 리소스가 수정되지 않았음을 알려준다. 따라서 클라이언트는 로컬pc에 저장된 캐시를 재사용(캐시로 리다이렉트 네트워크 요청 ㄴㄴ 함)
  304 응답은 응답에 메시지 바디를 포함하면 안된다.
  조건부 get, head 요청시 사용

## 4xx(Client Error)

- 클라리언트의 잘못
- 애초에 클라이언트에서 잘못 보내고 있기 때문에, 재시도가 실패함

### 401 Unauthorized

- 인증되지 않음
- Authentication(인증) 본인이 누구인지 확인, (로그인
- Authorization(인가) 권한부여 (ADMIN 권한처럼 특정 리소스에 접근할 수 있는 권한, 인증이 있어야 인가가 있음)

### 403 Forbidden

서버가 요청을 이해했지만 승인을 거부함

- 주로 인증 자격 증명은 있지만, 접근 권한이 없을 때
  ex) 어드민 등급이 아닌 사용자가 어드민 권한 필요한 요청 했을 때

### 404 Not Found

요청 리소스를 찾을 수 없음

- 요청 리소스가 서버에 없음
- 클라이언트가 권한이 부족한 리소스에 접근할 때 해당 리소스를 숨기고 싶을 때

## 5xx(Server Error)

- 서버 문제로 오류 발생
- 서버에 문제가 있기 때문에 재시도 하면 성공할 수도 있음(복구가 되거나 등등)
